<h1 id="notify-all-distributors-of-the-new-ice-cream-line">Notify all
distributors of the new ice cream line</h1>
<h2 id="background">Background</h2>
<p>The food development, marketing, production, and quality teams at
Best For You Organics (BFYOC) have released the details about their new
line of ice creams to the sales department. The sales department has now
asked your team to allow for notification of the main contact at each
distributor with the information about the new line so they can review
and start sending in orders.</p>
<p>In this challenge you will create a workflow between Best For You
Organics CRM systems (Dynamics 365) and the company’s distributors.</p>
<h2 id="challenge">Challenge</h2>
<p>Your team should implement an HTTP triggered workflow that will
generate an HTML email with the list of products, and then send an email
to each of the main contacts at the distributors.</p>
<p>BFYOC has provided HTML that you can use as a starting point for the
body of the emails.</p>
<p><strong>Note that this HTML includes a section that you need to
programmatically loop through each product to finish creating the
table.</strong></p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;body</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;background-color: whitesmoke; color: #454545; font-family:&#39;Gill Sans&#39;,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st"> &#39;Gill Sans MT&#39;, Calibri, &#39;Trebuchet MS&#39;, sans-serif; padding-bottom: 3em;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;table</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;width:100%; color:#454545&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;tr&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;td</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;width:11em;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;img</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;margin-left:1em;&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ot">        src=</span><span class="st">&quot;https://serverlessoh.azureedge.net/public/ice-cream-2202561_320-circle.jpg&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ot">          height=</span><span class="st">&quot;160&quot;</span> <span class="er">width</span><span class="ot">=</span><span class="st">&quot;160&quot;</span> <span class="er">alt</span><span class="ot">=</span><span class="st">&quot;Fruit Ice Cream&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;/td&gt;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;td&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;p</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;font-style: italic; font-size: 50px;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight:600; margin-left: 1em;&quot;</span><span class="kw">&gt;</span>Best For You Organics<span class="kw">&lt;/p&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;/td&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/tr&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/table&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;p</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;text-align: center; font-style: italic; font-size:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">  80px;&quot;</span><span class="kw">&gt;</span>New Ice Cream Line!<span class="kw">&lt;/p&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;p</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;margin:2em 0em; font-size: 20px; text-align: center;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  Best For You Organics have a new line of fruit flavored ice creams.</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  Below is the information so you can start the ordering process:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/p&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;table</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;width:100%; border-top: 1px solid #454545;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">  border-bottom: 1px solid #454545; color:#454545; padding: 1em; font-size: 20px;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;thead&gt;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;tr&gt;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;th</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;padding-bottom: 1em;&quot;</span> <span class="er">align</span><span class="ot">=</span><span class="st">&quot;left&quot;</span><span class="kw">&gt;</span>Ice Cream<span class="kw">&lt;/th&gt;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;th</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;padding-bottom: 1em;&quot;</span> <span class="er">align</span><span class="ot">=</span><span class="st">&quot;left&quot;</span><span class="kw">&gt;</span>Description<span class="kw">&lt;/th&gt;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;th</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;padding-bottom: 1em;&quot;</span> <span class="er">align</span><span class="ot">=</span><span class="st">&quot;left&quot;</span><span class="kw">&gt;</span>Product ID<span class="kw">&lt;/th&gt;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;/tr&gt;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/thead&gt;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;tbody</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;font-size: 16px;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">&lt;!-- LOOP THROUGH EACH PRODUCT HERE AND CREATE A TABLE ROW ENTRY FOR EACH --&gt;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/tbody&gt;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/table&gt;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;p</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;text-align: center; margin-top: 3em;font-size: 20px;&quot;</span><span class="kw">&gt;</span>Please contact</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  your representative at Best For You Organics to get more information..<span class="kw">&lt;/p&gt;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>You can access the list of products via the <code>GetProducts</code>
method in the existing Azure Function in your subscription.</p>
<p>You can retrieve the main contacts of the distributors from the
distributor’s Dynamics 365 CRM systems with the following detail:</p>
<ul>
<li><p>User:
<code>duser@microsoftopenhack.onmicrosoft.com</code></p></li>
<li><p>Password: <code>pass@word1</code></p></li>
<li><p>Environment:
<code>Microsoft OpenHack (msftopenhack)</code></p></li>
<li><p>Entity: <code>Contacts</code></p></li>
</ul>
<blockquote>
<p>Viewing records to select the entity from the distributor’s Dynamics
365 CRM system can take several seconds. Please be patient.</p>
</blockquote>
<p>The <code>Email</code> field from each contact contains the email
address to be used for each distributor contact.</p>
<p>The email should also contain your team number in the subject. Feel
free to also add the email address of someone in your team in CC so you
can see what the emails look like.</p>
<blockquote>
<p>HINT: The same credentials for user and password as listed above can
also be used to send emails from <code>Office 365 Outlook</code> Add
your own email address to the list and/or review the workflow executions
to see the emails sent to validate the emails are sent as expected to
multiple distributors.</p>
</blockquote>
<h2 id="success-criteria">Success Criteria</h2>
<ul>
<li><p>The email looks correct in an HTML format and with the list of
products</p></li>
<li><p>Your coach will be able to validate that the distributors have
received the email with your HTML content</p></li>
<li><p>Make sure your team number is in the email subject</p></li>
<li><p>Once the coach has validated the email, show the implementation
to them</p></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><p><a
href="https://docs.microsoft.com/azure/connectors/connectors-create-api-crmonline">Create
and manage records in Dynamics 365 using Azure Logic Apps</a></p></li>
<li><p><a
href="https://docs.microsoft.com/connectors/commondataservice/">Microsoft
Dataverse (legacy)</a></p></li>
<li><p><a
href="https://docs.microsoft.com/azure/connectors/connect-common-data-service#list-records-based-on-a-filter">List
Records using a Common Data Service (Microsoft Dataverse)
connector</a></p></li>
<li><p><a href="https://docs.microsoft.com/connectors/office365/">Office
365 Connector</a></p></li>
<li><p><a
href="https://docs.microsoft.com/azure/logic-apps/logic-apps-control-flow-loops">Loops
in Logic Apps</a></p></li>
<li><p><a
href="https://docs.microsoft.com/azure/logic-apps/logic-apps-create-variables-store-values">Create
variables for saving and managing values in Azure Logic
Apps</a></p></li>
<li><p><a
href="https://docs.microsoft.com/azure/logic-apps/logic-apps-perform-data-operations">Perform
data operations in Azure Logic Apps</a></p></li>
<li><p><a
href="https://docs.microsoft.com/azure/logic-apps/logic-apps-workflow-actions-triggers">Logic
Apps workflow actions and triggers</a></p></li>
</ul>
<h2 id="progress-diagram">Progress Diagram</h2>
<figure>
<img
src="https://serverlessoh.azureedge.net/public/distributor-notification-progress-diagram.jpg"
alt="Distributor notification progress diagram" />
<figcaption aria-hidden="true">Distributor notification progress
diagram</figcaption>
</figure>
